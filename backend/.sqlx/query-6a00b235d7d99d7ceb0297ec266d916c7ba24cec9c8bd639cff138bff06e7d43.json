{
  "db_name": "PostgreSQL",
  "query": "\n                    SELECT\n                    s.*,\n                    array_agg(\n                        distinct jsonb_build_object('id', rs.route_id, 'stop_type', rs.stop_type)\n                    ) AS routes,\n                    array_agg(\n                        distinct jsonb_build_object(\n                            'id',\n                            t.id,\n                            'route_id',\n                            t.route_id,\n                            'direction',\n                            t.direction,\n                            'assigned',\n                            t.assigned,\n                            'created_at',\n                            t.created_at,\n                            'stop_times',\n                            (\n                                select\n                                    jsonb_agg(st)\n                                from\n                                    (\n                                        select\n                                            st.stop_id,\n                                            st.arrival,\n                                            st.departure\n                                        from\n                                            stop_times st\n                                        where\n                                            st.trip_id = t.id\n                                        order by\n                                            st.arrival > now()\n                                    ) as st\n                            )\n                        )\n                    ) as trips\n                FROM\n                    stops s\n                    LEFT JOIN route_stops rs ON s.id = rs.stop_id\n                    LEFT JOIN stop_times st ON s.id = st.stop_id\n                    LEFT JOIN trips t ON st.trip_id = t.id\n                WHERE\n                    s.id = ANY($1)\n                GROUP BY\n                    s.id;\n                    ",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "id",
        "type_info": "Varchar"
      },
      {
        "ordinal": 1,
        "name": "name",
        "type_info": "Varchar"
      },
      {
        "ordinal": 2,
        "name": "ada",
        "type_info": "Bool"
      },
      {
        "ordinal": 3,
        "name": "notes",
        "type_info": "Varchar"
      },
      {
        "ordinal": 4,
        "name": "borough",
        "type_info": "Varchar"
      },
      {
        "ordinal": 5,
        "name": "routes",
        "type_info": "JsonbArray"
      },
      {
        "ordinal": 6,
        "name": "trips",
        "type_info": "JsonbArray"
      }
    ],
    "parameters": {
      "Left": [
        "TextArray"
      ]
    },
    "nullable": [
      false,
      false,
      false,
      true,
      false,
      null,
      null
    ]
  },
  "hash": "6a00b235d7d99d7ceb0297ec266d916c7ba24cec9c8bd639cff138bff06e7d43"
}
